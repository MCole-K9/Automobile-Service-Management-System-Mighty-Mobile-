import{_ as C}from"./DashboardLayout.7bb8fe63.js";import{L as O}from"./LoadingAnimation.f8ba8661.js";import{B as d}from"./BackendService.f40324f4.js";import{_ as D}from"./Request.a759d573.js";import{d as k,r as g,o,c as n,a as t,w as h,p as m,t as b,b as x,e as I,B as u,z as U,k as y,F as w,m as V}from"./index.e669858e.js";import{_ as j}from"./plugin-vue_export-helper.21dcd24c.js";const A=k({name:"AddVehicle",props:["vehicle"],data(){return{imagePlaceHolder:""}},components:{},methods:{uploadImage(e){let l=new FileReader;l.addEventListener("load",async i=>{var c,p;this.imagePlaceHolder=String((c=i.target)==null?void 0:c.result);let r=this.getBase64StringFromDataURL((p=i.target)==null?void 0:p.result);this.$emit("imageUpload",r)}),l.readAsDataURL(e.target.files[0])},getBase64StringFromDataURL(e){return e.replace("data:","").replace(/^.+,/,"")}},created(){}}),M={class:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center"},S={class:"mx-auto flex flex-col space-y-4 w-full"},L=t("label",{class:"text-center w-full p-2 bg-ourGrey shadow-lg",for:"vmake"},"Vehicle Make",-1),E={class:"mx-auto flex flex-col space-y-4 w-full"},H=t("label",{class:"text-center w-full p-2 bg-ourGrey shadow-lg",for:"vmodel"},"Vehicle Model",-1),F={class:"mx-auto flex flex-col space-y-4 w-full min-w-52"},R=t("label",{class:"text-center w-full p-2 bg-ourGrey shadow-lg",for:"vyear"},"Vehicle Year",-1),P={class:"flex items-center space-x-3"},J={class:"mx-auto flex flex-col space-y-4 w-full min-w-52"},G=t("label",{class:"text-center w-full p-2 bg-ourGrey shadow-lg",for:"vplate"},"License Plate",-1),N={class:"mx-auto flex flex-col space-y-4 w-full min-w-fit text-left"},T={class:"text-center w-full p-2 bg-ourGrey shadow-lg",for:"vimage"};function q(e,l,i,r,c,p){const f=g("FormKit");return o(),n("div",M,[t("div",S,[L,h(t("input",{class:"input w-full input-bordered",type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>e.vehicle.make=a),id:"vmake"},null,512),[[m,e.vehicle.make]])]),t("div",E,[H,h(t("input",{class:"input w-full input-bordered",type:"text","onUpdate:modelValue":l[1]||(l[1]=a=>e.vehicle.model=a),id:"vmodel"},null,512),[[m,e.vehicle.model]])]),t("div",F,[R,t("div",P,[h(t("input",{type:"range",min:"1990",max:"2025","onUpdate:modelValue":l[2]||(l[2]=a=>e.vehicle.year=a),class:"range range-sm text-ourGrey flex-grow-1"},null,512),[[m,e.vehicle.year]]),h(t("input",{class:"input w-full input-bordered",type:"number",id:"vyear","onUpdate:modelValue":l[3]||(l[3]=a=>e.vehicle.year=a)},null,512),[[m,e.vehicle.year]])])]),t("div",J,[G,h(t("input",{class:"input w-full input-bordered",type:"text","onUpdate:modelValue":l[4]||(l[4]=a=>e.vehicle.licensePlate=a),id:"vplate"},null,512),[[m,e.vehicle.licensePlate]])]),t("div",N,[t("label",T,b(e.vehicle.image==null?"Upload":"Change")+" Image",1),x(f,{type:"file",accept:".jpg,.jpeg,.png",help:"Select an image",multiple:"false",onChange:e.uploadImage,id:"vimage",name:"Vehicle name",validation:"required","validation-visibility":"live"},null,8,["onChange"])])])}var W=j(A,[["render",q]]);const v=I(),Y=k({name:"UserVehiclesView.vue",components:{DashboardLayout:C,Request:D,AddVehicleComponent:W,loadingAnimation:O},data(){return{userVehicles:{},allJobs:[],jobsDoneOnVehicle:[],loading:!1,emptyVehicleObject:{},add:!1,vehicleObject:{},imageBase64String:"",errorMsg:"",IDToBeDeleted:{},processingVehicle:!1,imageAdded:{}}},created(){this.getAllVehicles()},methods:{async getAllVehicles(){let e=await d.getUserVehicles(v.User.id);console.log(e==null?void 0:e.data),this.userVehicles=e==null?void 0:e.data},async getJobsDoneOnVehicle(e){this.loading=!0,this.jobsDoneOnVehicle=[];let l=await d.getAllJobs();this.allJobs=l==null?void 0:l.data,this.allJobs.forEach(i=>{i.vehicleId==e&&i.completed&&(this.jobsDoneOnVehicle.push(i),console.log(i))}),this.loading=!1},async addVehicle(){var e;if(this.vehicleObject.make!=""&&this.vehicleObject.model!=""&&this.vehicleObject.licensePlate!=""&&this.imageBase64String!=""){this.processingVehicle=!0;let l=await d.imageUpload(this.vehicleObject.make+this.vehicleObject.make+this.vehicleObject.year,this.imageBase64String);this.vehicleObject.image=l.data.url,console.log(this.vehicleObject),await d.registerVehicle(v.User.id,this.vehicleObject),this.getAllVehicles(),(e=document.getElementById("addVehicleModal"))==null||e.click(),this.processingVehicle=!1,this.imageAdded=!1}else this.errorMsg="Please fill out all fields"},async updateVehicle(){var l;if(this.processingVehicle=!0,this.imageBase64String!=""){let i=await d.imageUpload(this.vehicleObject.make+this.vehicleObject.make+this.vehicleObject.year,this.imageBase64String);this.vehicleObject.image=i.data.url,this.imageBase64String=""}let e=await d.updateUserVehicle(v.User.id,this.vehicleObject);e!=null&&e.data.status?((l=document.getElementById("modalButton"))==null||l.click(),console.log("success"),this.errorMsg="",this.processingVehicle=!1,this.imageAdded=!1):this.errorMsg="Something went wrong"},async deleteVehicle(){var l;let e=await d.deleteVehicle(this.IDToBeDeleted);e!=null&&e.data.status?(this.userVehicles=this.userVehicles.filter(i=>i.id!=this.IDToBeDeleted),(l=document.getElementById("deleteConfirmation"))==null||l.click(),console.log("success")):console.log(e)},resetInput(){let e=document.getElementById("vimage"),l=document.getElementById("vmake"),i=document.getElementById("vmodel"),r=document.getElementById("vplate"),c=document.getElementById("vyear");l.value="",i.value="",r.value="",e.value="",c.value=""},getBase64ImageString(e){this.imageBase64String=e,this.imageAdded=!0}}}),z={class:"lg:px-12 p-3 lg:py-10"},K={class:"flex justify-between"},Q=t("p",{class:"text-gray-800 text-xl sm:text-2xl lg:text-4xl font-bold"},"Vehicles",-1),X={class:"grid grid-cols-1 xl:grid-cols-2 grid-flow-row gap-5 my-10"},Z={class:"bg-ourYellow rounded flex flex-col justify-start items-center md:grid lg:grid xl:flex 2xl:grid grid-rows-3 grid-cols-4 gap-4 h-fit p-4 min-w-96"},ee={class:"row-span-3 aspect-auto h-fit flex flex-col justify-center col-span-1"},te=["src"],le={class:"row-span-2 col-span-3 text-center sm:text-left px-3"},se={class:"font-semibold"},oe={class:""},ie={class:"row-span-2 col-span-3 flex justify-start px-3 gap-x-2"},ae=["onClick"],ne=t("span",{class:"hidden sm-600:block"},"work history",-1),de=t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})],-1),ce=[ne,de],re=["onClick"],he=t("span",{class:"hidden sm-600:block"},"edit",-1),me=t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),ue=[he,me],ge=["onClick"],pe=t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),be=[pe],fe=t("input",{type:"checkbox",id:"vehicleWorkHistory",class:"modal-toggle"},null,-1),ve={class:"modal lg:pl-60 modal-bottom sm:modal-middle"},_e={class:"modal-box relative sm:w-11/12 sm:max-w-5xl",style:{"max-height":"30rem"}},ye=t("label",{for:"vehicleWorkHistory",class:"btn btn-sm btn-circle absolute right-2 top-2"},"\u2715",-1),we=t("h3",{class:"font-bold text-xl text-center"},"Work History",-1),Ve={class:"overflow-x-auto w-full pt-8"},ke={class:"table w-full"},xe=t("thead",null,[t("tr",null,[t("th",null,[t("label",null,[t("input",{type:"checkbox",class:"checkbox"})])]),t("th",null,"From"),t("th",null,"For"),t("th",null,"Date"),t("th")])],-1),je={key:1,class:"text-lg font-medium text-center my-5 w-1/1 opacity-75"},Be=t("input",{type:"checkbox",id:"addVehicleModal",class:"modal-toggle"},null,-1),$e={class:"modal lg:pl-60 modal-bottom sm:modal-middle"},Ce={class:"modal-box relative rounded sm:rounded-box sm:w-11/12 sm:max-w-5xl"},Oe=t("label",{for:"addVehicleModal",id:"modalButton",class:"btn btn-sm btn-circle absolute right-2 top-5"},"\u2715",-1),De={key:0,class:"font-bold text-xl text-center my-5"},Ie={key:1,class:"font-bold text-xl text-center my-5"},Ue={class:"modal-action items-center"},Ae={class:"text-error font-medium mx-5"},Me={key:0},Se={key:0},Le=t("input",{type:"checkbox",id:"deleteConfirmation",class:"modal-toggle"},null,-1),Ee={for:"deleteConfirmation",class:"modal cursor-pointer"},He={class:"modal-box relative",for:""},Fe=t("h3",{class:"text-lg font-bold"},"Delete Vehicle?",-1),Re=t("p",{class:"py-4"},"Are you sure you want to delete this vehicle",-1),Pe={class:"modal-action items-center"},Je=t("label",{for:"deleteConfirmation",class:"btn btn-sm"},"cancel",-1);function Ge(e,l,i,r,c,p){const f=g("Request"),a=g("loadingAnimation"),B=g("AddVehicleComponent"),$=g("DashboardLayout");return o(),u($,null,{content:U(()=>[t("div",z,[t("span",K,[Q,t("label",{for:"addVehicleModal",class:"btn btn-sm lg:btn-md modal-button",onClick:l[0]||(l[0]=s=>{e.vehicleObject=e.emptyVehicleObject,e.add=!0,e.resetInput()})},"add a Vehicle")]),t("div",X,[(o(!0),n(w,null,y(e.userVehicles,s=>(o(),n("div",Z,[t("div",ee,[t("img",{src:s.image==null?"https://demofree.sirv.com/nope-not-here.jpg":String(s.image),class:"rounded max-h-36",alt:"Car Image"},null,8,te)]),t("div",le,[t("p",se,b(`${s.year} ${s.make} ${s.model}`),1),t("p",oe,"License plate #: "+b(s.licensePlate),1)]),t("div",ie,[t("label",{for:"vehicleWorkHistory",class:"btn btn-sm modal-button flex gap-x-2",onClick:_=>e.getJobsDoneOnVehicle(s.id)},ce,8,ae),t("label",{for:"addVehicleModal",class:"btn btn-sm flex gap-x-2",onClick:_=>{e.vehicleObject=s,e.add=!1,e.resetInput()}},ue,8,re),t("label",{for:"deleteConfirmation",class:"btn btn-sm btn-error flex gap-x-2",onClick:_=>e.IDToBeDeleted=Number(s.id)},be,8,ge)])]))),256))]),fe,t("div",ve,[t("div",_e,[ye,we,t("div",Ve,[t("table",ke,[xe,t("tbody",null,[(o(!0),n(w,null,y(e.jobsDoneOnVehicle,s=>(o(),u(f,{job:s,key:s.jobNumber},null,8,["job"]))),128))])]),e.loading?(o(),u(a,{key:0,class:"my-5"})):V("",!0),e.jobsDoneOnVehicle.length==0&&!e.loading?(o(),n("p",je,"No Jobs Yet")):V("",!0)])])]),Be,t("div",$e,[t("div",Ce,[Oe,e.add?(o(),n("h3",De,"Add new vehicle")):(o(),n("h3",Ie,"Edit vehicle")),x(B,{vehicle:e.vehicleObject,onImageUpload:e.getBase64ImageString},null,8,["vehicle","onImageUpload"]),t("div",Ue,[t("p",Ae,b(e.errorMsg),1),e.add?(o(),n("button",{key:0,class:"btn",onClick:l[1]||(l[1]=(...s)=>e.addVehicle&&e.addVehicle(...s))},[e.processingVehicle?(o(),u(a,{key:1})):(o(),n("span",Me,"Add Vehicle"))])):(o(),n("button",{key:1,class:"btn",onClick:l[2]||(l[2]=(...s)=>e.updateVehicle&&e.updateVehicle(...s))},[e.processingVehicle?(o(),u(a,{key:1})):(o(),n("span",Se,"Save Vehicle"))]))])])]),Le,t("label",Ee,[t("label",He,[Fe,Re,t("div",Pe,[Je,t("button",{class:"btn btn-error btn-sm",onClick:l[3]||(l[3]=(...s)=>e.deleteVehicle&&e.deleteVehicle(...s))},"Delete Vehicle")])])])])]),_:1})}var Ke=j(Y,[["render",Ge]]);export{Ke as default};
