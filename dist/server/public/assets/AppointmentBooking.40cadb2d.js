import{d as B,u as P,n as Y,e as q,f as g,g as T,h as p,i as L,o as r,c as a,j as o,a as e,w as d,v as I,F as C,k as j,t as M,l as c,m as u,p as x,q as N,b as J,s as z}from"./index.ae2c4fb3.js";import{B as R}from"./BackendService.0920bf56.js";import{_ as S}from"./RegisterForm.92b557e4.js";import{V as y}from"./Validation.efea6428.js";const W={key:0,class:"grid grid-cols-1 text-center mb-4"},H={class:"mx-auto flex flex-col space-y-4 w-full"},K=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"vmake"}," Select Vehicle",-1),O=e("option",{disabled:"",selected:""},"Select Vehicle",-1),Q=["value"],X={key:1,class:"grid grid-cols-1 sm:grid-cols-3 gap-6 text-center"},Z={class:"mx-auto flex flex-col space-y-4 w-full"},ee=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"vmake"},"Vehicle Make",-1),te={class:"mx-auto flex flex-col space-y-4 w-full"},le=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"vmodel"},"Vehicle Model",-1),se={class:"mx-auto flex flex-col space-y-4 w-full"},oe=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"vyear"},"Vehicle Year",-1),re={class:"flex items-center space-x-3"},ae={class:"grid sm:grid-cols-2 gap-4 mt-8"},ie={class:"mx-auto flex flex-col space-y-4 w-full"},ne=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"aptdate"},"Appointment Date",-1),de=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"apttime"},"Appointment Time",-1),ue={key:0,class:"mx-auto flex flex-col space-y-4 w-full"},pe=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg"},"Contact Information",-1),ce=e("p",{class:"px-2 my-2"},[e("small",null,"Note: This information will be used in the creation of your account")],-1),me={key:1,class:"mx-auto flex flex-col space-y-4 w-full"},xe=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg"},"Contact Information",-1),he=["value"],ye=["value"],be=["value"],fe={class:"grid sm:grid-cols-2 gap-4 mt-8"},ge={class:"mx-auto flex flex-col space-y-4 w-full"},we=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg",for:"problemDescription"},"Problem Description",-1),ve=z('<option disabled selected>First Noticed?</option><option value="Today">Today</option><option value="Yesterday">Yesterday</option><option value="Some Time This Week">Last 7 Days</option><option value="Some Time this Month">Some Time this Month</option>',5),ke=[ve],_e={class:"mx-auto flex flex-col space-y-4 w-full"},Ne=e("label",{class:"text-center w-full py-4 px-2 bg-ourGrey shadow-lg"},"Location",-1),Ee={class:"flex justify-center my-4"},Ve={key:2,type:"checkbox",id:"my-modal-3",class:"modal-toggle"},Me={class:"modal"},De={class:"modal-box relative w-3/4 max-w-5xl"},Ue=e("label",{for:"my-modal-3",class:"btn btn-sm btn-circle absolute right-2 top-2"},"\u2715",-1),Ae={name:"AppointmentBooking",components:{RegisterForm:S}},Ge=B({...Ae,emits:["eu-booked"],setup(Te,{emit:Ie}){const D=P(),E=Y(),n=q();let h=g({make:"",model:"",year:2006}),i=T({suggestedDate:new Date,problemDescription:"",streetAddress:"",town:"",parish:"",customerId:0,vehicle:h.value}),b=g("First Noticed?"),f=g(""),w=g(""),v=g(""),k=g(""),_=g("");function F(){V()?(E.splitName(f.value),E.User.email=w.value,E.User.phoneNumber=v.value):t.showErrorMsg=!0}async function U(m){return i.suggestedDate=new Date(`${k.value}T${_.value}`),i.problemDescription+=`. I First Noticed This Problem ${b.value} `,await R.makeAppointment(m,i)}async function G(){if(V()){const m=await U(n.User.id);console.log(m),n.loggedIn&&D.push("/dashboard")}else t.showErrorMsg=!0}async function $(m){try{const s=await U(m);D.push({path:"/login"})}catch(s){console.log({error:s,source:"onRegister Function in AppointmentBooking"})}}const t=T({vehicleMake:p(()=>!y.isEmpty(h.value.make)),vehicleModel:p(()=>!y.isEmpty(h.value.model)),vehicleYear:p(()=>!(h.value.year<1990)),location:{streetAddress:p(()=>!y.isEmpty(i.streetAddress)),town:p(()=>!y.isEmpty(i.town)),parish:p(()=>!y.isEmpty(i.parish))},problemDescription:p(()=>!y.isEmpty(i.problemDescription)),firstNoticed:p(()=>!y.isEmpty(b.value)&&b.value!="First Noticed?"),appointmentDate:p(()=>y.dateGteToday(k.value)),appointmentTime:p(()=>!y.isEmpty(_.value)),fullName:p(()=>!y.isEmpty(f.value)&&f.value.split(" ").length==2||n.loggedIn),email:p(()=>y.validEmail(w.value)||n.loggedIn),phoneNumber:p(()=>y.validPhoneNumber(v.value)||n.loggedIn),showErrorMsg:!1}),A=p(()=>{var m;return t.vehicleMake&&t.vehicleModel&&t.vehicleYear||Number.isInteger((m=i.vehicle)==null?void 0:m.id)});function V(){return t.appointmentDate&&t.appointmentTime&&t.email&&t.firstNoticed&&t.fullName&&t.phoneNumber&&t.problemDescription&&t.location.streetAddress&&t.location.town&&t.location.parish&&A.value}return L(async()=>{if(n.loggedIn){const m=await R.getUserVehicles(n.User.id);n.User.vehicles=m==null?void 0:m.data}}),(m,s)=>(r(),a(C,null,[o(n).loggedIn?(r(),a("div",W,[e("div",H,[K,d(e("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>o(i).vehicle=l),class:"select select-bordered w-full text-center",id:""},[O,(r(!0),a(C,null,j(o(n).User.vehicles,l=>(r(),a("option",{key:l.id,value:l},M(l.year)+" "+M(l.make)+" "+M(l.model),9,Q))),128))],512),[[I,o(i).vehicle]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${o(A)?"hidden":"block"}`)},"Vehicle Is Required",2)):u("",!0)])])):(r(),a("div",X,[e("div",Z,[ee,d(e("input",{class:"input w-full input-bordered",type:"text","onUpdate:modelValue":s[1]||(s[1]=l=>o(h).make=l),id:"vmake"},null,512),[[x,o(h).make]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.vehicleMake?"hidden":"block"}`)},"Vehicle Make Is Required",2)):u("",!0)]),e("div",te,[le,d(e("input",{class:"input w-full input-bordered",type:"text","onUpdate:modelValue":s[2]||(s[2]=l=>o(h).model=l),id:"vmodel"},null,512),[[x,o(h).model]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.vehicleModel?"hidden":"block"}`)},"Vehicle Model Is Required",2)):u("",!0)]),e("div",se,[oe,e("div",re,[d(e("input",{type:"range",min:"1990",max:"2025","onUpdate:modelValue":s[3]||(s[3]=l=>o(h).year=l),class:"range range-sm text-ourGrey flex-grow-1"},null,512),[[x,o(h).year]]),d(e("input",{class:"input w-full input-bordered",type:"number",id:"vyear","onUpdate:modelValue":s[4]||(s[4]=l=>o(h).year=l)},null,512),[[x,o(h).year]])]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.vehicleYear?"hidden":"block"}`)},"Vehicle Year Below 1990 is not allowed",2)):u("",!0)])])),e("div",ae,[e("div",null,[e("div",ie,[ne,d(e("input",{class:"input w-full input-bordered","onUpdate:modelValue":s[5]||(s[5]=l=>N(k)?k.value=l:k=l),type:"date",id:"aptdate"},null,512),[[x,o(k)]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.appointmentDate?"hidden":"block"}`)},"Invalid Date: Cannot Select a Date in the Past",2)):u("",!0),de,d(e("input",{class:"input w-full input-bordered","onUpdate:modelValue":s[6]||(s[6]=l=>N(_)?_.value=l:_=l),type:"time",id:"apttime"},null,512),[[x,o(_)]]),t.showErrorMsg?(r(),a("span",{key:1,class:c(`text-xs text-red-400 px-2 ${t.appointmentTime?"hidden":"block"}`)},"Appointment Time Required",2)):u("",!0)])]),e("div",null,[o(n).loggedIn?(r(),a("div",me,[xe,e("input",{class:"input w-full input-bordered",disabled:"",value:o(n).fullName,placeholder:"Full Name (John Doe)",type:"text",id:"name"},null,8,he),e("input",{class:"input w-full input-bordered",disabled:"",value:o(n).User.email,placeholder:"Email Address",type:"email",id:"current-user-email"},null,8,ye),e("input",{class:"input w-full input-bordered",disabled:"",value:o(n).User.phoneNumber,placeholder:"Phone Number",type:"text",id:"firstNam"},null,8,be)])):(r(),a("div",ue,[pe,d(e("input",{class:"input w-full input-bordered","onUpdate:modelValue":s[7]||(s[7]=l=>N(f)?f.value=l:f=l),placeholder:"Full Name (John Doe)",type:"text",id:"name"},null,512),[[x,o(f)]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.fullName?"hidden":"block"}`)},"Ensure that First name and Last Name is Entered",2)):u("",!0),d(e("input",{class:"input w-full input-bordered","onUpdate:modelValue":s[8]||(s[8]=l=>N(w)?w.value=l:w=l),placeholder:"Email Address",type:"email",id:"new-user-email"},null,512),[[x,o(w)]]),t.showErrorMsg?(r(),a("span",{key:1,class:c(`text-xs text-red-400 px-2 ${t.email?"hidden":"block"}`)},"Enter a Valid Email",2)):u("",!0),d(e("input",{class:"input w-full input-bordered","onUpdate:modelValue":s[9]||(s[9]=l=>N(v)?v.value=l:v=l),placeholder:"Phone Number",type:"text",id:"phone-number"},null,512),[[x,o(v)]]),t.showErrorMsg?(r(),a("span",{key:2,class:c(`text-xs text-red-400 px-2 ${t.phoneNumber?"hidden":"block"}`)},"Enter a Valid Phone Number",2)):u("",!0),ce]))])]),e("div",fe,[e("div",null,[e("div",ge,[we,d(e("textarea",{rows:"6",class:"textarea textarea-bordered","onUpdate:modelValue":s[10]||(s[10]=l=>o(i).problemDescription=l),placeholder:"Problem Description",id:"problemDescription"},null,512),[[x,o(i).problemDescription]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.problemDescription?"hidden":"block"}`)},"Problem Description Required",2)):u("",!0),d(e("select",{"onUpdate:modelValue":s[11]||(s[11]=l=>N(b)?b.value=l:b=l),class:"select select-bordered w-full",id:"firstNoticed"},ke,512),[[I,o(b)]]),t.showErrorMsg?(r(),a("span",{key:1,class:c(`text-xs text-red-400 px-2 ${t.firstNoticed?"hidden":"block"}`)},"First Notice Required",2)):u("",!0)])]),e("div",null,[e("div",_e,[Ne,d(e("input",{"onUpdate:modelValue":s[12]||(s[12]=l=>o(i).streetAddress=l),class:"input w-full input-bordered",placeholder:"Street Address",type:"text",name:"street_address",id:"street_address"},null,512),[[x,o(i).streetAddress]]),t.showErrorMsg?(r(),a("span",{key:0,class:c(`text-xs text-red-400 px-2 ${t.location.streetAddress?"hidden":"block"}`)},"Street Address Required",2)):u("",!0),d(e("input",{"onUpdate:modelValue":s[13]||(s[13]=l=>o(i).town=l),class:"input w-full input-bordered",placeholder:"City/Town",type:"text",name:"city",id:"city"},null,512),[[x,o(i).town]]),t.showErrorMsg?(r(),a("span",{key:1,class:c(`text-xs text-red-400 px-2 ${t.location.town?"hidden":"block"}`)},"City/Town Required",2)):u("",!0),d(e("input",{"onUpdate:modelValue":s[14]||(s[14]=l=>o(i).parish=l),class:"input w-full input-bordered",placeholder:"Parish",type:"text",name:"parish",id:"parish"},null,512),[[x,o(i).parish]]),t.showErrorMsg?(r(),a("span",{key:2,class:c(`text-xs text-red-400 px-2 ${t.location.parish?"hidden":"block"}`)},"Parish Required",2)):u("",!0)])])]),e("div",Ee,[o(n).loggedIn?(r(),a("button",{key:1,onClick:G,class:"btn bg-ourYellow border-ourYellow w-4/12 modal-button"},"Book Appointment")):(r(),a("label",{key:0,onClick:F,for:"my-modal-3",class:"btn bg-ourYellow border-ourYellow w-4/12 modal-button"},"Continue"))]),V()?(r(),a("input",Ve)):u("",!0),e("div",Me,[e("div",De,[Ue,J(S,{header:"Complete Booking by Creating An Account",onRegistered:$})])])],64))}});export{Ge as _};
